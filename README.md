# HAProxy 配置管理脚本

这是一个用于管理 HAProxy 配置的脚本，支持以下功能：

- 安装 HAProxy
- 配置 HAProxy（支持单一后端、负载均衡、故障转移模式）
- 启动、停止、重启 HAProxy 服务
- 显示 HAProxy 当前运行的配置规则
- 删除已配置的规则（按端口或备注）
- 导入和导出 HAProxy 配置
- 检查端口是否被占用，确保端口选择有效

## 脚本功能

### 1. 安装 HAProxy
此脚本支持在 Ubuntu/Debian 系统上自动安装 HAProxy。

### 2. 配置 HAProxy
您可以选择以下配置模式：

- **单一模式（单一后端）**：配置一个单一的后端服务。
- **负载均衡模式**：配置多个后端服务，使用负载均衡算法（如轮询）分配请求。
- **故障转移模式**：配置多个后端服务，启用故障转移功能，如果一个后端不可用，则自动切换到其他后端。

### 3. 启动、停止、重启 HAProxy 服务
支持使用 `systemctl` 启动、停止和重启 HAProxy 服务。

### 4. 配置管理
- **删除规则**：根据端口号或备注删除相应的配置规则。
- **导入和导出配置**：支持将当前 HAProxy 配置导出为文件，或从外部文件导入配置。

### 5. 端口检测
在添加新规则时，脚本会检测所选端口是否被占用。如果端口已被占用，系统会提示用户选择其他端口。

## 使用方法

1. 下载并解压缩脚本文件。
2. 赋予执行权限：
   ```bash
   chmod +x haproxy_manage.sh
   ```
3. 运行脚本：
   ```bash
   sudo ./haproxy_manage.sh
   ```
4. 根据提示选择操作。

## 常见问题

- **如何配置单一后端服务？**
  在脚本中选择 **单一模式（单一后端）**，然后输入后端服务的 IP 地址和端口即可。

- **如何配置负载均衡或故障转移？**
  在脚本中选择 **负载均衡模式** 或 **故障转移模式**，然后输入多个后端服务的 IP 地址。

- **端口被占用怎么办？**
  脚本会自动检测端口是否被占用，如果端口已被占用，系统会提示用户选择其他端口。

## 开发者

脚本由 [Your Name](https://github.com/yourgithub) 开发，欢迎提交问题和 PR。
